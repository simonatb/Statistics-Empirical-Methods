### 1. В кутия има 8 топки, номерирани от 1 до 8. Вадим произволна топка и я връщаме в кутията. Отново вадим произволна топка. Каква е вероятността да извадим два пъти една и съща топка?

```
exp.balls <- function(){
  t <- sample(c(1:8),size=2,replace=TRUE)
  t[1] == t[2]
}

prob.balls <- function(n){
  results <- replicate(n,exp.balls())
  sum(results) / n
}
prob.balls(10000)
```
### 2. В кутия има 3 различни чифта чорапи. Вадим в тъмното 2 чорапа. Каква е вероятността извадените два чорапа да са чифт?
```
exp.socks <- function(){
  t <- sample(rep(c(1,2,3),each=2),size=2,replace=FALSE)
  t[1] == t[2]
}

prob.socks <- function(n){
  results <- replicate(n,exp.socks())
  sum(results) / n
}
prob.socks(10000)
```
### 3. Иван има 4 ключа, но не знае кой е за неговата стая. Предполагаме, че ключовете са разбъркани по произволен начин. Иван пробва последователно с всеки от тях, като помни кой ключ е пробвал. Каква е вероятността да отключи с последния (четвъртия) ключ?
```
exp.keys <- function(){
  keys <- c(1,2,3,4)
  t <- sample(keys,size=4,replace=FALSE)
  t[4] == 1
}

prob.keys <- function(n){
  results <- replicate(n,exp.keys())
  sum(results) / n
}
prob.keys(10000)
```
### 4. Студент се явява на изпит с конспект от 20 въпроса. От тях не знае само 3 въпроса. На изпита си тегли 2 въпроса от конспекта. Каква е вероятността да знае само един от изтеглените въпроси?
```
exp.questions <- function(){
  questions <- c(1:20)
  unknown <- c(1:3)
  t <- sample(questions,size=2,replace=FALSE)
  (t[1] %in% unknown & ! (t[2]  %in% unknown) ) |
  (t[2] %in% unknown & !(t[1] %in% unknown) )
}
prob.questions <- function(n){
  results <- replicate(n,exp.questions())
  sum(results) / n
}
prob.questions(10000)

или

choose(17,1)*choose(3,1)/choose(20,2) / комбинации

или

exp.questions <- function(){
  questions <- c(rep(0,3),rep(1,17))
  t <- sample(questions,2,replace=FALSE)
  sum(x) == 1
}
prob.questions <- function(n){
  result <- replicate(n,exp.questions())
  sum(result) / n
}
prob.questions(10000)

```
### 5. Каква е вероятността в група от 25 човека поне двама да имат рожден ден на един и същи ден от годината?
```
prob.bday <- function(){
  bdays <- c(1:365)
  t <- sample(bdays,25,replace=TRUE)
  any(duplicated(t))
}
exp.bday <- function(n){
  results <- replicate(n,prob.bday)
  sum(results)/n
}
```
### 6. В отдел на фирма работят 20 човека. За Коледа те решават да си разменят подаръци. В кутия слагат 20 листчета, на всяко от които има едно име. Всеки тегли листче (без да го връща) и подарява на този, чието име е изтеглил. Каква е вероятността поне един да изтегли своето име?
```
prob.gifts <- function(){
  names <- c(1:20)
  t <- sample(names,20,replace=FALSE)
  d <- t - c(1:20)
  any(d==0)
}
exp.gifts <- function(n){
  results <- replicate(n,prob.gifts)
  sum(results)/n
}
```
### 7. На всеки от върховете на равностранен триъгълник има една мравка. Всяка мравка избира произволно един от другите два върха и тръгва към него. За единица време всяка мравка изминава разстоянието от един връх до друг. Две мравки могат да се разминат ако тръгнат една срещу друга. Каква е вероятността след единица време да има по една мравка на всеки връх?
```
exp.ants <- function(){
  a1 <- sample(c(2,3),1)
  a2 <- sample(c(1,3),1)
  a3 <- sample(c(1,2),1)
  a <- c(a1,a2,a3)
  length(unique(a)) == 3
  # any( duplicated(a) ) == F
  # all( c(1,2,3) %in% a )
}
prob.ants <- function(n){
  results <- replicate(n,exp.ants())
  sum(results)/n
}
```




